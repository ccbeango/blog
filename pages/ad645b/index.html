<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>高阶组件 | CcbeanBlog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/blog/img/favicon.ico">
    <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <meta name="description" content="web技术博客,简洁至上。JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,NodeJS,Node,Node.js,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,react,css3,html5,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/blog/assets/css/0.styles.76d42078.css" as="style"><link rel="preload" href="/blog/assets/js/app.0ed7b280.js" as="script"><link rel="preload" href="/blog/assets/js/2.7308dfd9.js" as="script"><link rel="preload" href="/blog/assets/js/95.81abfad5.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.166b2ca6.js"><link rel="prefetch" href="/blog/assets/js/100.194e839b.js"><link rel="prefetch" href="/blog/assets/js/101.0db39944.js"><link rel="prefetch" href="/blog/assets/js/102.e13c8470.js"><link rel="prefetch" href="/blog/assets/js/103.0ae2f2ee.js"><link rel="prefetch" href="/blog/assets/js/104.a261556e.js"><link rel="prefetch" href="/blog/assets/js/105.4d458a5f.js"><link rel="prefetch" href="/blog/assets/js/106.6d2f15cf.js"><link rel="prefetch" href="/blog/assets/js/107.a770982a.js"><link rel="prefetch" href="/blog/assets/js/108.0be9ce8f.js"><link rel="prefetch" href="/blog/assets/js/109.88d01e84.js"><link rel="prefetch" href="/blog/assets/js/11.faae5f41.js"><link rel="prefetch" href="/blog/assets/js/110.d3186629.js"><link rel="prefetch" href="/blog/assets/js/111.37d2b500.js"><link rel="prefetch" href="/blog/assets/js/112.d94648de.js"><link rel="prefetch" href="/blog/assets/js/113.a7cf5597.js"><link rel="prefetch" href="/blog/assets/js/114.a339354f.js"><link rel="prefetch" href="/blog/assets/js/115.597976cc.js"><link rel="prefetch" href="/blog/assets/js/116.c64f1f49.js"><link rel="prefetch" href="/blog/assets/js/117.bbbbb20b.js"><link rel="prefetch" href="/blog/assets/js/118.c9ba24ea.js"><link rel="prefetch" href="/blog/assets/js/119.25208df7.js"><link rel="prefetch" href="/blog/assets/js/12.782cd676.js"><link rel="prefetch" href="/blog/assets/js/120.2e0a20ad.js"><link rel="prefetch" href="/blog/assets/js/121.7bb8f6f5.js"><link rel="prefetch" href="/blog/assets/js/122.562fe94b.js"><link rel="prefetch" href="/blog/assets/js/123.9562f569.js"><link rel="prefetch" href="/blog/assets/js/124.fd67828f.js"><link rel="prefetch" href="/blog/assets/js/125.3262b310.js"><link rel="prefetch" href="/blog/assets/js/126.c6f106af.js"><link rel="prefetch" href="/blog/assets/js/127.4b7016d1.js"><link rel="prefetch" href="/blog/assets/js/128.b3ac8038.js"><link rel="prefetch" href="/blog/assets/js/129.3ef9af3d.js"><link rel="prefetch" href="/blog/assets/js/13.508b65ad.js"><link rel="prefetch" href="/blog/assets/js/130.4b925feb.js"><link rel="prefetch" href="/blog/assets/js/131.37cb5d18.js"><link rel="prefetch" href="/blog/assets/js/132.76026f1f.js"><link rel="prefetch" href="/blog/assets/js/133.5d3d2938.js"><link rel="prefetch" href="/blog/assets/js/134.89b4fe3b.js"><link rel="prefetch" href="/blog/assets/js/135.dd2731dc.js"><link rel="prefetch" href="/blog/assets/js/136.e5cacc53.js"><link rel="prefetch" href="/blog/assets/js/137.39282e0b.js"><link rel="prefetch" href="/blog/assets/js/138.b3801697.js"><link rel="prefetch" href="/blog/assets/js/14.88ac5afd.js"><link rel="prefetch" href="/blog/assets/js/15.b4227c88.js"><link rel="prefetch" href="/blog/assets/js/16.98d2ae02.js"><link rel="prefetch" href="/blog/assets/js/17.6f25717f.js"><link rel="prefetch" href="/blog/assets/js/18.ae934359.js"><link rel="prefetch" href="/blog/assets/js/19.ffe2dcb2.js"><link rel="prefetch" href="/blog/assets/js/20.2c614eab.js"><link rel="prefetch" href="/blog/assets/js/21.4b7f3180.js"><link rel="prefetch" href="/blog/assets/js/22.03f8def7.js"><link rel="prefetch" href="/blog/assets/js/23.861aebfe.js"><link rel="prefetch" href="/blog/assets/js/24.e842cb60.js"><link rel="prefetch" href="/blog/assets/js/25.5685dfd1.js"><link rel="prefetch" href="/blog/assets/js/26.9487cf2a.js"><link rel="prefetch" href="/blog/assets/js/27.cd3b98f4.js"><link rel="prefetch" href="/blog/assets/js/28.1010db9b.js"><link rel="prefetch" href="/blog/assets/js/29.cff77b90.js"><link rel="prefetch" href="/blog/assets/js/3.b0a270e2.js"><link rel="prefetch" href="/blog/assets/js/30.d9d88b77.js"><link rel="prefetch" href="/blog/assets/js/31.4c816fae.js"><link rel="prefetch" href="/blog/assets/js/32.c414f2c2.js"><link rel="prefetch" href="/blog/assets/js/33.cae1fde7.js"><link rel="prefetch" href="/blog/assets/js/34.c149f32c.js"><link rel="prefetch" href="/blog/assets/js/35.36ce97e5.js"><link rel="prefetch" href="/blog/assets/js/36.b7c514b6.js"><link rel="prefetch" href="/blog/assets/js/37.d9459ed5.js"><link rel="prefetch" href="/blog/assets/js/38.84d4e80e.js"><link rel="prefetch" href="/blog/assets/js/39.21769d8b.js"><link rel="prefetch" href="/blog/assets/js/4.1de495bd.js"><link rel="prefetch" href="/blog/assets/js/40.ba8b2c33.js"><link rel="prefetch" href="/blog/assets/js/41.dbc723df.js"><link rel="prefetch" href="/blog/assets/js/42.6d7ee2ec.js"><link rel="prefetch" href="/blog/assets/js/43.3065c2de.js"><link rel="prefetch" href="/blog/assets/js/44.95652c6b.js"><link rel="prefetch" href="/blog/assets/js/45.1bfb7eee.js"><link rel="prefetch" href="/blog/assets/js/46.21f42bfd.js"><link rel="prefetch" href="/blog/assets/js/47.5cf0a7f8.js"><link rel="prefetch" href="/blog/assets/js/48.80e7bcba.js"><link rel="prefetch" href="/blog/assets/js/49.75bf925a.js"><link rel="prefetch" href="/blog/assets/js/5.7e93193d.js"><link rel="prefetch" href="/blog/assets/js/50.1a08250f.js"><link rel="prefetch" href="/blog/assets/js/51.63d67d9a.js"><link rel="prefetch" href="/blog/assets/js/52.4527b3c2.js"><link rel="prefetch" href="/blog/assets/js/53.928eb7b1.js"><link rel="prefetch" href="/blog/assets/js/54.b2c8392c.js"><link rel="prefetch" href="/blog/assets/js/55.84f7c241.js"><link rel="prefetch" href="/blog/assets/js/56.6773809d.js"><link rel="prefetch" href="/blog/assets/js/57.aed02421.js"><link rel="prefetch" href="/blog/assets/js/58.16532c6b.js"><link rel="prefetch" href="/blog/assets/js/59.43238c8c.js"><link rel="prefetch" href="/blog/assets/js/6.d42d0f48.js"><link rel="prefetch" href="/blog/assets/js/60.d868f9ec.js"><link rel="prefetch" href="/blog/assets/js/61.8bc02b72.js"><link rel="prefetch" href="/blog/assets/js/62.83e6c8d0.js"><link rel="prefetch" href="/blog/assets/js/63.ade81187.js"><link rel="prefetch" href="/blog/assets/js/64.cc73a529.js"><link rel="prefetch" href="/blog/assets/js/65.d002206a.js"><link rel="prefetch" href="/blog/assets/js/66.f0665b6d.js"><link rel="prefetch" href="/blog/assets/js/67.11c613ec.js"><link rel="prefetch" href="/blog/assets/js/68.8e2479dd.js"><link rel="prefetch" href="/blog/assets/js/69.02772367.js"><link rel="prefetch" href="/blog/assets/js/7.2b3bcb3f.js"><link rel="prefetch" href="/blog/assets/js/70.3545ebb5.js"><link rel="prefetch" href="/blog/assets/js/71.b7c76516.js"><link rel="prefetch" href="/blog/assets/js/72.035b6ee2.js"><link rel="prefetch" href="/blog/assets/js/73.9feda52a.js"><link rel="prefetch" href="/blog/assets/js/74.d62cf235.js"><link rel="prefetch" href="/blog/assets/js/75.db2ada7c.js"><link rel="prefetch" href="/blog/assets/js/76.8569647d.js"><link rel="prefetch" href="/blog/assets/js/77.ebb5e006.js"><link rel="prefetch" href="/blog/assets/js/78.463a3566.js"><link rel="prefetch" href="/blog/assets/js/79.25bf57ea.js"><link rel="prefetch" href="/blog/assets/js/8.3cf902c7.js"><link rel="prefetch" href="/blog/assets/js/80.4d3043a3.js"><link rel="prefetch" href="/blog/assets/js/81.e6ac7aff.js"><link rel="prefetch" href="/blog/assets/js/82.39390874.js"><link rel="prefetch" href="/blog/assets/js/83.52a99a2b.js"><link rel="prefetch" href="/blog/assets/js/84.4efad80d.js"><link rel="prefetch" href="/blog/assets/js/85.dce1dc90.js"><link rel="prefetch" href="/blog/assets/js/86.3050d700.js"><link rel="prefetch" href="/blog/assets/js/87.67d7c4e3.js"><link rel="prefetch" href="/blog/assets/js/88.4a3a4132.js"><link rel="prefetch" href="/blog/assets/js/89.861690de.js"><link rel="prefetch" href="/blog/assets/js/9.f2b8862e.js"><link rel="prefetch" href="/blog/assets/js/90.f1cdccba.js"><link rel="prefetch" href="/blog/assets/js/91.3abb6471.js"><link rel="prefetch" href="/blog/assets/js/92.66e441c7.js"><link rel="prefetch" href="/blog/assets/js/93.3ae60e73.js"><link rel="prefetch" href="/blog/assets/js/94.b6f4569f.js"><link rel="prefetch" href="/blog/assets/js/96.eaafaf11.js"><link rel="prefetch" href="/blog/assets/js/97.f464844d.js"><link rel="prefetch" href="/blog/assets/js/98.5b594a5f.js"><link rel="prefetch" href="/blog/assets/js/99.8a12c6d2.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.76d42078.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/img/EB-logo.png" alt="CcbeanBlog" class="logo"> <span class="site-name can-hide">CcbeanBlog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/blog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/4f29ea/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/blog/pages/5bb2dc/" class="nav-link">HTML+CSS</a></li><li class="dropdown-subitem"><a href="/blog/pages/d0b9bd/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/blog/pages/ff6413/" class="nav-link">React</a></li></ul></li><li class="dropdown-item"><h4>系列笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/note/react-learn/" class="nav-link">React使用学习</a></li><li class="dropdown-subitem"><a href="/blog/note/vue2-code/" class="nav-link">Vue2源码探究</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><a href="/blog/nodejs/" class="link-title">Node</a> <span class="title" style="display:none;">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Node文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/1cce55/" class="nav-link">基础</a></li><li class="dropdown-subitem"><a href="/blog/pages/be0ea7/" class="nav-link">问题</a></li><li class="dropdown-subitem"><a href="/blog/pages/6e080e/" class="nav-link">框架</a></li></ul></li><li class="dropdown-item"><h4>系列笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/note/data-structures-and-algorithms/" class="nav-link">数据结构与算法</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="打包工具" class="dropdown-title"><a href="/blog/packtool/" class="link-title">打包工具</a> <span class="title" style="display:none;">打包工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>构建工具文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/a542bb/" class="nav-link">webpack</a></li></ul></li><li class="dropdown-item"><h4>系列笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/note/webpack5/" class="nav-link">Webpack5使用学习</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/3bd9c5/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/4db4cb/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/9f95d1/" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/c44d61/" class="nav-link">小技巧</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/9c8278/" class="nav-link">杂记</a></li><li class="dropdown-item"><h4>系列笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/note/protocol-buffers/" class="nav-link">Protobuf Buffers</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/blog/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/ccbeango/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://avatars.githubusercontent.com/u/16501284?v=4"> <div class="blogger-info"><h3>Ccbean</h3> <span>靡不有初，鲜克有终</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/blog/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/4f29ea/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/blog/pages/5bb2dc/" class="nav-link">HTML+CSS</a></li><li class="dropdown-subitem"><a href="/blog/pages/d0b9bd/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/blog/pages/ff6413/" class="nav-link">React</a></li></ul></li><li class="dropdown-item"><h4>系列笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/note/react-learn/" class="nav-link">React使用学习</a></li><li class="dropdown-subitem"><a href="/blog/note/vue2-code/" class="nav-link">Vue2源码探究</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Node" class="dropdown-title"><a href="/blog/nodejs/" class="link-title">Node</a> <span class="title" style="display:none;">Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Node文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/1cce55/" class="nav-link">基础</a></li><li class="dropdown-subitem"><a href="/blog/pages/be0ea7/" class="nav-link">问题</a></li><li class="dropdown-subitem"><a href="/blog/pages/6e080e/" class="nav-link">框架</a></li></ul></li><li class="dropdown-item"><h4>系列笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/note/data-structures-and-algorithms/" class="nav-link">数据结构与算法</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="打包工具" class="dropdown-title"><a href="/blog/packtool/" class="link-title">打包工具</a> <span class="title" style="display:none;">打包工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>构建工具文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/pages/a542bb/" class="nav-link">webpack</a></li></ul></li><li class="dropdown-item"><h4>系列笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/note/webpack5/" class="nav-link">Webpack5使用学习</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/pages/3bd9c5/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/4db4cb/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/9f95d1/" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/c44d61/" class="nav-link">小技巧</a></li><li class="dropdown-item"><!----> <a href="/blog/pages/9c8278/" class="nav-link">杂记</a></li><li class="dropdown-item"><h4>系列笔记</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/note/protocol-buffers/" class="nav-link">Protobuf Buffers</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/blog/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/ccbeango/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/blog/pages/3f937c/" class="sidebar-link">Hello World</a></li><li><a href="/blog/pages/65114a/" class="sidebar-link">JSX语法</a></li><li><a href="/blog/pages/919785/" class="sidebar-link">JSX语法的本质</a></li><li><a href="/blog/pages/c5633c/" class="sidebar-link">脚手架</a></li><li><a href="/blog/pages/bd5f26/" class="sidebar-link">什么是组件化开发</a></li><li><a href="/blog/pages/f34018/" class="sidebar-link">组件化开发</a></li><li><a href="/blog/pages/3b1483/" class="sidebar-link">setState详解和React性能优化</a></li><li><a href="/blog/pages/77cea2/" class="sidebar-link">受控和非受控组件</a></li><li><a href="/blog/pages/ad645b/" aria-current="page" class="active sidebar-link">高阶组件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/blog/pages/ad645b/#高阶组件" class="sidebar-link">高阶组件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog/pages/ad645b/#认识高阶组件" class="sidebar-link">认识高阶组件</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/ad645b/#高阶组件的使用" class="sidebar-link">高阶组件的使用</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/ad645b/#props的增强" class="sidebar-link">props的增强</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/ad645b/#渲染判断鉴权" class="sidebar-link">渲染判断鉴权</a></li><li class="sidebar-sub-header level4"><a href="/blog/pages/ad645b/#生命周期劫持" class="sidebar-link">生命周期劫持</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/ad645b/#高阶函数的意义" class="sidebar-link">高阶函数的意义</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/blog/pages/ad645b/#组件补充" class="sidebar-link">组件补充</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/blog/pages/ad645b/#ref转发" class="sidebar-link">ref转发</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/ad645b/#portals" class="sidebar-link">Portals</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/ad645b/#fragment" class="sidebar-link">Fragment</a></li><li class="sidebar-sub-header level3"><a href="/blog/pages/ad645b/#strictmode" class="sidebar-link">StrictMode</a></li></ul></li></ul></li><li><a href="/blog/pages/809a87/" class="sidebar-link">React的样式</a></li><li><a href="/blog/pages/ce6916/" class="sidebar-link">React的过渡动画</a></li><li><a href="/blog/pages/7f1191/" class="sidebar-link">ReactHooks的使用</a></li><li><a href="/blog/pages/18ce7b/" class="sidebar-link">Redux的使用</a></li><li><a href="/blog/pages/d3c53b/" class="sidebar-link">React-Redux</a></li><li><a href="/blog/pages/facc20/" class="sidebar-link">Redux中间件和state管理</a></li><li><a href="/blog/pages/f60ca3/" class="sidebar-link">React-router</a></li><li><a href="/blog/pages/96924f/" class="sidebar-link">React打包发布</a></li><li><a href="/blog/pages/1b0384/" class="sidebar-link">React SSR</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/blog/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/blog/note/react-learn/#React核心技术与开发实战" data-v-06225672>React核心技术与开发实战</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/ccbeango" target="_blank" title="作者" class="beLink" data-v-06225672>ccbean</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2021-06-23</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">高阶组件<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="react学习-九-高阶组件和组件补充"><a href="#react学习-九-高阶组件和组件补充" class="header-anchor">#</a> React学习（九）——高阶组件和组件补充</h1> <h2 id="高阶组件"><a href="#高阶组件" class="header-anchor">#</a> 高阶组件</h2> <h3 id="认识高阶组件"><a href="#认识高阶组件" class="header-anchor">#</a> 认识高阶组件</h3> <p>什么是高阶组件呢？相信很多同学都听说过，也用过 <code>高阶函数</code>，它们非常相似，所以我们可以先来回顾一下什么是 <code>高阶函数</code>。</p> <p>高阶函数的至少满足以下条件之一：</p> <ul><li>接受一个或多个函数作为输入；</li> <li>输出一个函数；</li></ul> <p>JavaScript中比较常见的filter、map、reduce都是高阶函数。</p> <p>那么什么是高阶组件呢？</p> <ul><li>高阶组件的英文是 <strong>Higher-Order Components</strong>，简称为 <code>HOC</code>；</li> <li>官方的定义：<strong>高阶组件是参数为组件，返回值为新组件的函数</strong>；</li></ul> <p>我们可以进行如下的解析：</p> <ul><li>首先， <code>高阶组件</code> 本身不是一个组件，而是一个函数；</li> <li>其次，这个函数的参数是一个组件，返回值也是一个组件；</li></ul> <p>高阶组件的调用过程类似于这样：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> EnhancedComponent <span class="token operator">=</span> <span class="token function">higherOrderComponent</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>高阶函数的编写过程类似于这样：</p> <div class="language-react extra-class"><pre class="language-text"><code>function higherOrderComponent(WrapperComponent) {
  return class NewComponent extends PureComponent {
    render() {
      return &lt;WrapperComponent/&gt;
    }
  }
}
</code></pre></div><p>在ES6中，类表达式中类名是可以省略的（匿名类），所以可以可以写成下面的写法：</p> <div class="language-react extra-class"><pre class="language-text"><code>function higherOrderComponent(WrapperComponent) {
  return class extends PureComponent {
    render() {
      return &lt;WrapperComponent/&gt;
    }
  }
}
</code></pre></div><p>另外，组件的名称都可以通过displayName来修改，在dev阶段可以在devtool中看到对应名字：</p> <div class="language-react extra-class"><pre class="language-text"><code>function higherOrderComponent(WrapperComponent) {
  class NewComponent extends PureComponent {
    render() {
      return &lt;WrapperComponent/&gt;
    }
  }
  NewComponent.displayName = 'Ccbeango';
  return NewComponent；
}
</code></pre></div><p>完整的代码，我们可以这样来编写：</p> <div class="language-react extra-class"><pre class="language-text"><code>import React, { PureComponent } from 'react';

function higherOrderComponent(WrapperComponent) {
  class NewComponent extends PureComponent {
    render() {
      // this.props扩展接收传递的参数
      return &lt;WrapperComponent {...this.props}/&gt;
    }
  }

  // NewComponent.displayName = 'Ccbeango';
  return NewComponent;
}

class App extends PureComponent {
  render() {
    return (
      &lt;div&gt;
        App
      &lt;/div&gt;
    )
  }
}

export default higherOrderComponent(App);
</code></pre></div><p>高阶组件并不是React API的一部分，它是基于React的组合特性而形成的设计模式；</p> <p>高阶组件在一些React第三方库中非常常见：</p> <ul><li>比如redux中的connect；</li> <li>比如react-router中的withRouter；</li></ul> <h3 id="高阶组件的使用"><a href="#高阶组件的使用" class="header-anchor">#</a> 高阶组件的使用</h3> <h4 id="props的增强"><a href="#props的增强" class="header-anchor">#</a> props的增强</h4> <p><strong>不修改原有代码的情况下，添加新的props</strong></p> <p>这里是劫持props做操作。</p> <p>假如有如下案例：</p> <div class="language-react extra-class"><pre class="language-text"><code>import React, { PureComponent } from 'react';

function enhanceComponent(WrapperComponent, otherProps) {
  class NewComponent extends PureComponent {
    render() {
      return &lt;WrapperComponent {...this.props} {...otherProps} /&gt;
    }
  }

  // NewComponent.displayName = 'Ccbeango';
  return NewComponent;
}

class Person extends PureComponent {
  render () {
    return (
      &lt;h2&gt;Home: {this.props.name}-年龄：{this.props.age}-身高{this.props.height}&lt;/h2&gt;
    );
  }
}

const EnhancePerson = enhanceComponent(Person, { height: '1.83' });
const EnhancePerson2 = enhanceComponent(Person, { height: '1.77' });

class App extends PureComponent {
  render() {
    return (
      &lt;div&gt;
        App
        &lt;EnhancePerson name=&quot;ccbean&quot; age=&quot;18&quot; /&gt;
        &lt;EnhancePerson2 name=&quot;tom&quot; age=&quot;20&quot; /&gt;
      &lt;/div&gt;
    )
  }
}

export default App;
</code></pre></div><p>我们可以通过一个高阶组件，让使用者在不破坏原有结构的情况下对某个组件增强props：</p> <div class="language-react extra-class"><pre class="language-text"><code>function enhanceProps(WrapperCpn, otherProps) {
  // 函数式组件
  return props =&gt; &lt;WrapperCpn {...props} {...otherProps} /&gt;
}

const EnhanceHeader = enhanceProps(Header, {height: 1.88})

function enhanceComponent(WrapperComponent, otherProps) {
  return class NewComponent extends PureComponent {
    render() {
      return &lt;WrapperComponent {...this.props} {...otherProps} /&gt;
    }
  }
}
</code></pre></div><p><strong>利用高阶组件来共享Context</strong></p> <p>利用高阶组件来共享Context属性</p> <div class="language-react extra-class"><pre class="language-text"><code>import React, { PureComponent, createContext } from 'react';

const UserContext = createContext({
  nickname: &quot;默认&quot;,
  level: -1
})

function Header(props) {
  return (
    &lt;UserContext.Consumer&gt;
      {
        value =&gt; {
          const { nickname, level } = value;
          return &lt;h2&gt;Header {&quot;昵称:&quot; + nickname + &quot;等级&quot; + level}&lt;/h2&gt;
        }
      }
    &lt;/UserContext.Consumer&gt;
  )
}

function Footer(props) {
  return (
    &lt;UserContext.Consumer&gt;
      {
        value =&gt; {
          const { nickname, level } = value;
          return &lt;h2&gt;Footer {&quot;昵称:&quot; + nickname + &quot;等级&quot; + level}&lt;/h2&gt;
        }
      }
    &lt;/UserContext.Consumer&gt;
  )
}

const EnhanceHeader = enhanceProps(Header, { height: 1.88 })

export default class App extends PureComponent {
  render() {
    return (
      &lt;div&gt;
        &lt;UserContext.Provider value={{ nickname: &quot;why&quot;, level: 90 }}&gt;
          &lt;Header /&gt;
          &lt;Footer /&gt;
        &lt;/UserContext.Provider&gt;
      &lt;/div&gt;
    )
  }
}
</code></pre></div><p>利用高阶组件<code>withUser</code>：</p> <ul><li>多个地方需要使用context时，使用高阶组件，无需每个地方都写相同的逻辑代码。</li></ul> <div class="language-react extra-class"><pre class="language-text"><code>import React, { PureComponent, createContext } from 'react';

const UserContext = createContext({
  nickname: &quot;默认&quot;,
  level: -1
})

function withUser(WrapperCpn) {
  return props =&gt; {
    return (
      &lt;UserContext.Consumer&gt;
        {
          value =&gt; {
            return &lt;WrapperCpn {...props} {...value}/&gt;
          }
        }
      &lt;/UserContext.Consumer&gt;
    )
  }
}

function Header(props) {
  const { nickname, level } = props;
  return &lt;h2&gt;Header {&quot;昵称:&quot; + nickname + &quot;等级:&quot; + level}&lt;/h2&gt;
}


function Footer(props) {
  const { nickname, level } = props;
  return &lt;h2&gt;Footer {&quot;昵称:&quot; + nickname + &quot;等级:&quot; + level}&lt;/h2&gt;
}

const UserHeader = withUser(Header);
const UserFooter = withUser(Footer);

export default class App extends PureComponent {
  render() {
    return (
      &lt;div&gt;
        &lt;UserContext.Provider value={{ nickname: &quot;why&quot;, level: 90 }}&gt;
          &lt;UserHeader /&gt;
          &lt;UserFooter /&gt;
        &lt;/UserContext.Provider&gt;
      &lt;/div&gt;
    )
  }
}
</code></pre></div><h4 id="渲染判断鉴权"><a href="#渲染判断鉴权" class="header-anchor">#</a> 渲染判断鉴权</h4> <p>在开发中，我们可能遇到这样的场景：</p> <ul><li>某些页面是必须用户登录成功才能进行进入；</li> <li>如果用户没有登录成功，那么直接跳转到登录页面；</li></ul> <p>这里是劫持组件做操作。</p> <p>这个时候，我们就可以使用高阶组件来完成鉴权操作：</p> <div class="language-react extra-class"><pre class="language-text"><code>function LoginPage() {
  return &lt;h2&gt;LoginPage&lt;/h2&gt;
}

function CartPage() {
  return &lt;h2&gt;CartPage&lt;/h2&gt;
}

export default class App extends PureComponent {
  render() {
    return (
      &lt;div&gt;
        &lt;CartPage/&gt;
      &lt;/div&gt;
    )
  }
}
</code></pre></div><p>编写鉴权的高阶组件：</p> <div class="language-react extra-class"><pre class="language-text"><code>function loginAuth(Page) {
  return props =&gt; {
    if (props.isLogin) {
      return &lt;Page/&gt;
    } else {
      return &lt;LoginPage/&gt;
    }
  }
}
</code></pre></div><p>完整的代码如下：</p> <div class="language-react extra-class"><pre class="language-text"><code>import React, { PureComponent } from 'react';

function loginAuth(Page) {
  return props =&gt; {
    if (props.isLogin) {
      return &lt;Page/&gt;
    } else {
      return &lt;LoginPage/&gt;
    }
  }
}

function LoginPage() {
  return &lt;h2&gt;LoginPage&lt;/h2&gt;
}

function CartPage() {
  return &lt;h2&gt;CartPage&lt;/h2&gt;
}

const AuthCartPage = loginAuth(CartPage);

export default class App extends PureComponent {
  render() {
    return (
      &lt;div&gt;
        &lt;AuthCartPage isLogin={true}/&gt;
      &lt;/div&gt;
    )
  }
}
</code></pre></div><p>类似的实际应用还有很多，都可借助高阶组件实现。</p> <h4 id="生命周期劫持"><a href="#生命周期劫持" class="header-anchor">#</a> 生命周期劫持</h4> <div class="language-react extra-class"><pre class="language-text"><code>import React, { PureComponent } from 'react';

class Home extends PureComponent {

  UNSAFE_componentWillMount() {
    this.begin = Date.now();
  }

  componentDidMount() {
    this.end = Date.now();
    const interval = this.end - this.begin;
    console.log(`Home渲染使用时间:${interval}`)
  }

  render() {
    return (
      &lt;div&gt;
        &lt;h2&gt;Home&lt;/h2&gt;
        &lt;p&gt;我是home的元素,哈哈哈&lt;/p&gt;
      &lt;/div&gt;
    )
  }
}

class Detail extends PureComponent {
  UNSAFE_componentWillMount() {
    this.begin = Date.now();
  }

  componentDidMount() {
    this.end = Date.now();
    const interval = this.end - this.begin;
    console.log(`Detail渲染使用时间:${interval}`)
  }

  render() {
    return (
      &lt;div&gt;
        &lt;h2&gt;Detail&lt;/h2&gt;
        &lt;p&gt;我是detail的元素,哈哈哈&lt;/p&gt;
      &lt;/div&gt;
    )
  }
}

export default class App extends PureComponent {
  render() {
    return (
      &lt;div&gt;
        &lt;Home/&gt;
        &lt;Detail/&gt;
      &lt;/div&gt;
    )
  }
}
</code></pre></div><p>我们可以定义如下高阶组件：</p> <div class="language-react extra-class"><pre class="language-text"><code>function logRenderTime(WrapperCpn) {
  return class extends PureComponent {
    UNSAFE_componentWillMount() {
      this.begin = Date.now();
    }

    componentDidMount() {
      this.end = Date.now();
      const interval = this.end - this.begin;
      console.log(`Home渲染使用时间:${interval}`)
    }

    render() {
      return &lt;WrapperCpn {...this.props}/&gt;
    }
  }
}

const LogHome = logRenderTime(Home);
const LogDetail = logRenderTime(Detail);
</code></pre></div><p>完整代码如下：</p> <div class="language-react extra-class"><pre class="language-text"><code>import React, { PureComponent } from 'react';

class Home extends PureComponent {
  UNSAFE_componentWillMount() {
    this.begin = Date.now();
  }

  componentDidMount() {
    this.end = Date.now();
    const interval = this.end - this.begin;
    console.log(`Home渲染使用时间:${interval}`)
  }

  render() {
    return (
      &lt;div&gt;
        &lt;h2&gt;Home&lt;/h2&gt;
        &lt;p&gt;我是home的元素,哈哈哈&lt;/p&gt;
      &lt;/div&gt;
    )
  }
}

class Detail extends PureComponent {
  UNSAFE_componentWillMount() {
    this.begin = Date.now();
  }

  componentDidMount() {
    this.end = Date.now();
    const interval = this.end - this.begin;
    console.log(`Detail渲染使用时间:${interval}`)
  }

  render() {
    return (
      &lt;div&gt;
        &lt;h2&gt;Detail&lt;/h2&gt;
        &lt;p&gt;我是detail的元素,哈哈哈&lt;/p&gt;
      &lt;/div&gt;
    )
  }
}

export default class App extends PureComponent {
  render() {
    return (
      &lt;div&gt;
        &lt;Home/&gt;
        &lt;Detail/&gt;
      &lt;/div&gt;
    )
  }
}
</code></pre></div><h3 id="高阶函数的意义"><a href="#高阶函数的意义" class="header-anchor">#</a> 高阶函数的意义</h3> <p>我们会发现利用高阶组件可以针对某些React代码进行更加优雅的处理。</p> <p>其实早期的React有提供组件之间的一种复用方式是mixin，目前已经不再建议使用：</p> <ul><li><code>Mixin</code> 可能会相互依赖，相互耦合，不利于代码维护</li> <li>不同的<code>Mixin</code>中的方法可能会相互冲突</li> <li><code>Mixin</code>非常多时，组件是可以感知到的，甚至还要为其做相关处理，这样会给代码造成滚雪球式的复杂性</li></ul> <p>当然，HOC也有自己的一些缺陷：</p> <ul><li><code>HOC</code>需要在原组件上进行包裹或者嵌套，如果大量使用<code>HOC</code>，将会产生非常多的嵌套，这让调试变得非常困难；</li> <li><code>HOC</code>可以劫持<code>props</code>，在不遵守约定的情况下也可能造成冲突；</li></ul> <p>Hooks的出现，是开创性的，它解决了很多React之前的存在的问题，比如this指向问题、比如hoc的嵌套复杂度问题等等；</p> <h2 id="组件补充"><a href="#组件补充" class="header-anchor">#</a> 组件补充</h2> <h3 id="ref转发"><a href="#ref转发" class="header-anchor">#</a> ref转发</h3> <p>之前我们也说过，函数组件无法获取<code>ref</code>，因为函数组件没有实例对象。</p> <div class="language-react extra-class"><pre class="language-text"><code>import React, { createRef, PureComponent } from &quot;react&quot;;

class Home extends PureComponent {
  render() {
    return &lt;div&gt;Home&lt;/div&gt;;
  }
}

function Profile() {
  return &lt;div&gt;Profile&lt;/div&gt;
}

export default class App extends PureComponent {
  constructor(props) {
    super(props);

    this.titleRef = createRef();
    this.homeRef = createRef();
    this.profileRef = createRef();
  }

  render() {
    return (
      &lt;div&gt;
        &lt;h2 ref={this.titleRef}&gt;Hello React&lt;/h2&gt;
        &lt;Home ref={this.homeRef} /&gt;
        &lt;Profile ref={this.profileRef}/&gt;
        &lt;button onClick={e =&gt; this.printRef()}&gt;打印ref&lt;/button&gt;
      &lt;/div&gt;
    );
  }

  printRef() {
    console.log(this.titleRef)
    console.log(this.homeRef)
    console.log(this.profileRef)
  }
}
</code></pre></div><p>上面的代码我们会看到如下警告：</p> <div class="language- extra-class"><pre class="language-text"><code>index.js:1 Warning: Function components cannot be given refs. Attempts to access this ref will fail. Did you mean to use React.forwardRef()?
</code></pre></div><p>此时使用<code>forwardRef</code>高阶组件可实现将ref转发。</p> <div class="language-react extra-class"><pre class="language-text"><code>import React, { createRef, forwardRef, PureComponent } from &quot;react&quot;;

class Home extends PureComponent {
  render() {
    return &lt;div&gt;Home&lt;/div&gt;;
  }
}


const Profile = forwardRef((props, ref) =&gt; {
  return &lt;div ref={ref}&gt;Profile&lt;/div&gt;
})

export default class App extends PureComponent {
  constructor(props) {
    super(props);

    this.titleRef = createRef();
    this.homeRef = createRef();
    this.profileRef = createRef();
  }

  render() {
    return (
      &lt;div&gt;
        &lt;h2 ref={this.titleRef}&gt;Hello React&lt;/h2&gt;
        &lt;Home ref={this.homeRef} /&gt;
        &lt;Profile ref={this.profileRef}/&gt;
        &lt;button onClick={e =&gt; this.printRef()}&gt;打印ref&lt;/button&gt;
      &lt;/div&gt;
    );
  }

  printRef() {
    console.log(this.titleRef)
    console.log(this.homeRef)
    console.log(this.profileRef)
  }
}
</code></pre></div><h3 id="portals"><a href="#portals" class="header-anchor">#</a> Portals</h3> <p>某些情况下，我们希望渲染的内容独立于父组件，甚至是独立于当前挂载到的DOM元素中（默认都是挂载到id为root的DOM元素上的）。</p> <p>Portal 提供了一种将子节点渲染到存在于父组件以外的 DOM 节点的优秀的方案：</p> <ul><li>第一个参数（<code>child</code>）是任何可渲染的 React 子元素，例如一个元素，字符串或 fragment；</li> <li>第二个参数（<code>container</code>）是一个 DOM 元素；</li></ul> <div class="language-react extra-class"><pre class="language-text"><code>ReactDOM.createPortal(child, container)
</code></pre></div><p>通常来讲，当你从组件的 render 方法返回一个元素时，该元素将被挂载到 DOM 节点中离其最近的父节点：</p> <div class="language-react extra-class"><pre class="language-text"><code>render() {
  // React 挂载了一个新的 div，并且把子元素渲染其中
  return (
    &lt;div&gt;      
      {this.props.children}
    &lt;/div&gt;  
  );
}
</code></pre></div><p>然而，有时候将子元素插入到 DOM 节点中的不同位置也是有好处的：</p> <div class="language-react extra-class"><pre class="language-text"><code>render() {
  // React 并*没有*创建一个新的 div。它只是把子元素渲染到 `domNode` 中。
  // `domNode` 是一个可以在任何位置的有效 DOM 节点。
  return ReactDOM.createPortal(
    this.props.children,
    domNode  
  );
}
</code></pre></div><p><strong>比如说，我们准备开发一个Modal组件，它可以将它的子组件渲染到屏幕的中间位置：</strong></p> <p>步骤一：修改index.html添加新的节点</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 新节点 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>modal<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>步骤二：编写这个节点的样式：</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">#modal</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> -50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>步骤三：编写组件代码</p> <div class="language-react extra-class"><pre class="language-text"><code>import React, { PureComponent } from 'react';
import ReactDOM from 'react-dom';

class Modal extends PureComponent {
  constructor(props) {
    super(props);
  }

  render() {
    return ReactDOM.createPortal(
      this.props.children,
      document.getElementById(&quot;modal&quot;)
    )
  }
}

export default class App extends PureComponent {
  render() {
    return (
      &lt;div&gt;
        &lt;Modal&gt;
          &lt;h2&gt;我是标题&lt;/h2&gt;
        &lt;/Modal&gt;
      &lt;/div&gt;
    )
  }
}
</code></pre></div><h3 id="fragment"><a href="#fragment" class="header-anchor">#</a> Fragment</h3> <p>在之前的开发中，我们总是在一个组件中返回内容时包裹一个div元素：</p> <div class="language-react extra-class"><pre class="language-text"><code>export default class App extends PureComponent {
  render() {
    return (
      &lt;div&gt;
        &lt;h2&gt;当前计数: 0&lt;/h2&gt;
        &lt;button&gt;+1&lt;/button&gt;
        &lt;button&gt;-1&lt;/button&gt;
      &lt;/div&gt;
    )
  }
}
</code></pre></div><p>我们会发现多了一个div元素：</p> <ul><li>这个div元素对于某些场景是需要的（比如我们就希望放到一个div元素中，再针对性设置样式）</li> <li>某些场景下这个div是没有必要的，比如当前这里我可能希望所有的内容直接渲染到root中即可；</li></ul> <p>我们希望可以不渲染这样一个div应该如何操作呢？</p> <ul><li>使用Fragment</li> <li>Fragment 允许你将子列表分组，而无需向 DOM 添加额外节点；</li></ul> <p>React还提供了Fragment的短语法：</p> <ul><li>它看起来像空标签 <code>&lt;&gt; &lt;/&gt;</code>；</li></ul> <div class="language-react extra-class"><pre class="language-text"><code>export default class App extends PureComponent {
  render() {
    return (
      &lt;&gt;
        &lt;h2&gt;当前计数: 0&lt;/h2&gt;
        &lt;button&gt;+1&lt;/button&gt;
        &lt;button&gt;-1&lt;/button&gt;
      &lt;/&gt;
    )
  }
}
</code></pre></div><p>但是，如果我们需要在Fragment中添加key，那么就不能使用短语法：</p> <div class="language-react extra-class"><pre class="language-text"><code>{
  this.state.friends.map((item, index) =&gt; {
    return (
      &lt;Fragment key={item.name}&gt;
        &lt;div&gt;{item.name}&lt;/div&gt;
        &lt;div&gt;{item.age}&lt;/div&gt;
      &lt;/Fragment&gt;
    )
  })
}
</code></pre></div><p>这里是不支持如下写法的：</p> <div class="language-react extra-class"><pre class="language-text"><code>&lt;key={item.name}&gt;
  &lt;div&gt;{item.name}&lt;/div&gt;
  &lt;div&gt;{item.age}&lt;/div&gt;
&lt;/&gt;
</code></pre></div><p>下面的<code>Column</code>如果使用div包裹，html结果不对将会出现渲染问题，使用<code>Fragment</code>就可以解决这个问题。</p> <div class="language-react extra-class"><pre class="language-text"><code>import React, { PureComponent, Fragment } from &quot;react&quot;;

class Columns extends React.Component {
  render() {
    return (
      &lt;Fragment&gt;
        &lt;td&gt;Hello&lt;/td&gt;
        &lt;td&gt;World&lt;/td&gt;
      &lt;/Fragment&gt;
    );
  }
}

export default class Table extends PureComponent {
  render() {
    return (
      &lt;table&gt;
        &lt;tbody&gt;
          &lt;tr&gt;
            &lt;Columns /&gt;
          &lt;/tr&gt;
        &lt;/tbody&gt;
      &lt;/table&gt;
    );
  }
}

</code></pre></div><h3 id="strictmode"><a href="#strictmode" class="header-anchor">#</a> StrictMode</h3> <p><code>StrictMode</code> 是一个用来突出显示应用程序中潜在问题的工具。</p> <ul><li>与 <code>Fragment</code> 一样，<code>StrictMode</code> 不会渲染任何可见的 UI；</li> <li>它为其后代元素触发额外的检查和警告；</li> <li>严格模式检查仅在开发模式下运行；它们不会影响生产构建；</li></ul> <p>可以为应用程序的任何部分启用严格模式：</p> <ul><li>不会对 <code>Header</code> 和 <code>Footer</code> 组件运行严格模式检查；</li> <li>但是，<code>ComponentOne</code> 和 <code>ComponentTwo</code> 以及它们的所有后代元素都将进行检查；</li></ul> <div class="language-react extra-class"><pre class="language-text"><code>import React from 'react';

function ExampleApplication() {
  return (
    &lt;div&gt;
      &lt;Header /&gt;
      &lt;React.StrictMode&gt;
        &lt;div&gt;
          &lt;ComponentOne /&gt;
          &lt;ComponentTwo /&gt;
        &lt;/div&gt;
      &lt;/React.StrictMode&gt;
      &lt;Footer /&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><p><strong>但是检测，到底检测什么呢？</strong></p> <ol><li>识别不安全的生命周期：</li></ol> <div class="language-react extra-class"><pre class="language-text"><code>class Home extends PureComponent {
  UNSAFE_componentWillMount() {

  }

  render() {
    return &lt;h2&gt;Home&lt;/h2&gt;
  }
}
</code></pre></div><p>警告</p> <div class="language-react extra-class"><pre class="language-text"><code>index.js:1 Warning: Using UNSAFE_componentWillMount in strict mode is not recommended and may indicate bugs in your code. See https://reactjs.org/link/unsafe-component-lifecycles for details.

* Move code with side effects to componentDidMount, and set initial state in the constructor.

Please update the following components: App
</code></pre></div><ol start="2"><li>使用过时的ref API</li></ol> <div class="language-react extra-class"><pre class="language-text"><code>class Home extends PureComponent {
  UNSAFE_componentWillMount() {

  }

  render() {
    return &lt;h2 ref=&quot;home&quot;&gt;Home&lt;/h2&gt;
  }
}
</code></pre></div><p>警告</p> <div class="language-react extra-class"><pre class="language-text"><code>index.js:1 Warning: A string ref, &quot;home&quot;, has been found within a strict mode tree. String refs are a source of potential bugs and should be avoided. We recommend using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref
</code></pre></div><ol start="3"><li>使用废弃的findDOMNode方法</li></ol> <p>在之前的React API中，可以通过findDOMNode来获取DOM，不过已经不推荐使用了</p> <ol start="4"><li><p>检查意外的副作用</p> <ul><li>这个组件的constructor会被调用两次；</li> <li>这是严格模式下故意进行的操作，让你来查看在这里写的一些逻辑代码被调用多次时，是否会产生一些副作用；</li> <li>在生产环境中，是不会被调用两次的；</li></ul> <div class="language-react extra-class"><pre class="language-text"><code>class Home extends PureComponent {
  constructor(props) {
    super(props);

    console.log(&quot;home constructor&quot;);
  }

  UNSAFE_componentWillMount() {

  }

  render() {
    return &lt;h2 ref=&quot;home&quot;&gt;Home&lt;/h2&gt;
  }
}
</code></pre></div></li> <li><p>检测过时的context API</p></li></ol> <p>早期的Context是通过static属性声明Context对象属性，通过getChildContext返回Context对象等方式来使用Context的；</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/ccbeango/blog/edit/master/docs/React核心技术与开发实战/09.高阶组件.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/11/10, 12:11:50</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/blog/pages/77cea2/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">受控和非受控组件</div></a> <a href="/blog/pages/809a87/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">React的样式</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/blog/pages/77cea2/" class="prev">受控和非受控组件</a></span> <span class="next"><a href="/blog/pages/809a87/">React的样式</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/blog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/blog/pages/78ad41/"><div>
            阅读精通正则表达式总结
            <!----></div></a> <span class="date">09-29</span></dt></dl><dl><dd>02</dd> <dt><a href="/blog/pages/1e1cbc/"><div>
            项目搭建规范的配置
            <!----></div></a> <span class="date">07-15</span></dt></dl><dl><dd>03</dd> <dt><a href="/blog/pages/4c97eb/"><div>
            Vite的使用
            <!----></div></a> <span class="date">07-03</span></dt></dl> <dl><dd></dd> <dt><a href="/blog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="liuyh940@gamil.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/ccbeango" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://space.bilibili.com/316494239" title="Bilibili" target="_blank" class="iconfont icon-bilibili"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2018-2023
    <span>Ccbeango</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.0ed7b280.js" defer></script><script src="/blog/assets/js/2.7308dfd9.js" defer></script><script src="/blog/assets/js/95.81abfad5.js" defer></script>
  </body>
</html>
