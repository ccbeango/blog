---
title: Webpack中的TreeShaking以及其它优化
date: 2022-06-12 11:22:56
permalink: /pages/b29660/
categories:
  - Webpack5使用学习
tags:
  - 
---
# Webpack中的TreeShaking以及其它优化

## TreeShaking

### 认识TreeShaking

Tree Shaking是一个术语，在计算机中表示消除死代码（dead_code）。

最早起源于LISP，用于消除未调用的代码。LISP编程的核心就是函数，其中有一个概念叫作纯函数。

纯函数表示函数的执行不会产生任何副作用，那么如果这个函数没被调用过，就可以放心地删除未调用的函数，这也是为什么要求我们在进行函数式编程时，尽量使用纯函数的原因之一。

后来Tree Shaking也被应用于其他的语言，比如JavaScript、Dart。

JavaScript的Tree Shaking，源自于打包工具[rollup](https://rollupjs.org/guide/en/#introduction)。

* Tree Shaking依赖于ES Module的静态语法分析，即不执行任何的代码，可以明确知道模块的依赖关系；
* webpack2正式内置支持了ES2015模块，和检测未使用模块的能力；
* 在webpack4正式扩展了这个能力，并且通过`package.json`的`sideEffects`属性作为标记，告知webpack在编译时，哪里文件可以安全的删除掉；
* webpack5中，也提供了对部分[CommonJS的tree shaking支持](https://github.com/webpack/changelog-v5#commonjs-tree-shaking)；

### Webpack中实现TreeShaking

webpack实现Tree Shaking采用了两种不同的方案：

* `usedExports`：通过标记某些函数是否被使用，之后通过Terser来进行优化的；
* `sideEffects`：跳过整个模块/文件，直接查看该文件是否有副作用；

这是两种独立方案，每种方案有自己对应的使用场景。

> https://webpack.docschina.org/guides/tree-shaking#clarifying-tree-shaking-and-sideeffects
>
> [`sideEffects`](https://webpack.docschina.org/configuration/optimization/#optimizationsideeffects) 和 [`usedExports`](https://webpack.docschina.org/configuration/optimization/#optimizationusedexports)（更多被认为是 tree shaking）是两种不同的优化方式。

### usedExports

### sideEffects



